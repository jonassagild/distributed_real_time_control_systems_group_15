% assumptions: 
% the code assumes that the data has reached steady state. 

% values from response
values = [322.00 319.00 315.00 309.00 303.00 295.00 287.00 279.00 271.00 262.00 254.00 246.00 238.00 230.00 223.00 216.00 208.00 202.00 195.00 189.00 186.00 181.00 180.00 178.00 176.00 174.00 175.00 174.00 175.00 172.00 172.00 173.00 173.00 174.00 171.00 171.00 173.00 174.00 174.00 172.00 173.00 173.00 176.00 174.00 176.00 175.00 174.00 177.00 177.00 176.00 174.00 176.00 177.00 176.00 175.00 177.00 176.00 176.00 176.00 177.00 176.00 178.00 175.00 176.00 176.00 177.00 177.00 178.00 175.00 175.00 177.00 178.00 178.00 176.00 177.00 177.00 179.00 178.00 177.00 179.00 178.00 178.00 179.00 179.00 179.00 175.00 176.00 177.00 178.00 179.00 177.00 177.00 179.00 179.00 179.00 177.00 178.00 179.00 180.00 179.00 176.00 179.00 179.00 179.00 178.00 179.00 180.00 178.00 179.00 178.00 182.00 180.00 181.00 180.00 179.00 182.00 180.00 182.00 180.00 182.00 180.00 182.00 180.00 180.00 179.00 182.00 181.00 180.00 179.00 181.00 180.00 179.00 182.00 180.00 180.00 179.00 182.00 180.00 181.00 179.00 180.00 179.00 178.00 182.00 181.00 180.00 181.00 178.00 179.00 179.00 180.00 179.00 179.00 178.00 179.00 181.00 178.00 179.00 179.00 179.00 179.00 179.00 179.00 179.00 179.00 178.00 181.00 180.00 179.00 180.00 179.00 180.00 179.00 179.00 178.00 180.00 181.00 180.00 179.00 180.00 179.00 180.00 179.00 179.00 178.00 180.00 181.00 180.00 180.00 177.00 179.00 180.00 180.00 177.00 178.00 179.00 180.00 179.00 179.00 178.00 180.00 180.00 180.00 179.00 180.00 180.00 178.00 179.00 180.00 180.00 179.00 180.00 180.00 178.00 179.00 180.00 180.00 179.00 180.00 179.00 180.00 181.00 178.00 178.00 181.00 181.00 181.00 179.00 179.00 182.00 181.00 182.00 180.00 179.00 182.00 181.00 181.00 181.00 179.00 180.00 182.00 180.00 181.00 179.00 181.00 180.00 179.00 182.00 182.00 181.00 178.00 180.00 181.00 180.00 178.00 180.00 181.00 180.00 178.00 181.00 181.00 180.00 179.00 182.00 180.00 182.00 181.00 181.00 179.00 179.00 179.00 180.00 181.00 180.00 178.00 179.00 180.00 180.00 178.00 180.00 180.00 179.00 180.00 178.00 180.00 180.00 180.00 178.00 179.00 180.00 180.00 178.00 179.00 179.00 180.00 180.00 178.00 179.00 180.00 180.00 ];


change_u = 42;


x = 1:1:length(values);

plot(x, values);

% time_constant
time_constant_y_value = values(length(values))+(values(1)-values(length(values)))*0.63;

% find the time where values is closest to time_constant_y_value
prev_value = values(1);
for i = 1:1:length(values)
    if (prev_value > time_constant_y_value && time_constant_y_value > values(i))
        % time_constant_y_value is between last and this value. 
        % set this time i to be the time constant
        time_constant = i;
     
        
    elseif values(i) == time_constant_y_value
        % time_constant_y_value was equal to a value in values
        % we set this time i to be the time constant
        time_constant = i;
    
        
    end
    prev_value = values(i);
end
 

% sets static gain as the last value of values
change_lux = values(length(values)) - values(1);

static_gain = change_lux/change_u;
disp('static_gain:');
disp(static_gain);
disp('time_constant:');
disp(time_constant*1/(16*10^6));

% actual time_constant is 1/hz*time_constant



